<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Required meta tags -->
		<meta charest="uint8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">

		<!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Markazi+Text">
    <link rel="stylesheet" href="css/style.css">

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <script src="https://d3js.org/d3.v5.min.js"></script>
    

    <title class="col-12"> Large-scale Multi-class Image-based Cell Classification with Deep Learning </title>
		
	</head>
	<body style="padding: 48px 48px">
		<header class='container'>
		  	<h2 class="col-12" align="center" style="font-family: Times New Roman; padding-top: 36px"> Large-scale Multi-class Image-based Cell Classification with Deep Learning </h2>
        <h5 class="text-center font-italic font-weight-normal" style="padding-top: 16px; padding-bottom: 16px"> IEEE Journal of Biomedical and Health Informatics </h5>
        <nav class="text-center" style="width: 100%">
          <a href="#" style="font-family: cabin; margin-right: 20px"> Nan Meng </a>
          <a href="#" style="font-family: cabin; margin-right: 20px"> Edmund Y. Lam </a>
          <a href="#" style="font-family: cabin; margin-right: 20px"> Kevin K. Tsia </a>
          <a href="#" style="font-family: cabin"> Hayden K.-H. So </a>
        </nav>
        <nav class="text-center">
          <p style="font-family: cabin"> The University of Hong Kong </p>
        </nav>
		</header>
    <section class="container">
      <abstract>
        <h5 style="font-family: Markazi Text, serif; font-size: 30px"> <strong> Abstract </strong> </h5>
        <p align="justify" style="font-family: Markazi Text, serif; font-size: 24px; line-height: .9"> Recent advances in ultra-high-throughput optical microscopy have enabled a new generation of cell classification methodologies using image-based cell phenotypes alone. In contrast to the current single-cell analysis techniques that rely solely on slow and costly genetic/epigenetic analyses, these image-based classification methods allow morphological profiling and screening of thousands or even millions of single cells at a fraction of the cost. Furthermore, they have demonstrated the statistical significance required for understanding the role of cell heterogeneity in diverse biological applications, ranging from cancer screening to drug candidate identification/validation processes. This work examines the efficacies and opportunities presented by machine learning algorithms in processing largescale datasets with millions of label-free cell images. An automatic single-cell classification framework using a convolutional neural network (CNN) has been developed. A comparative analysis of its efficiency in classifying large datasets against conventional k-nearest neighbors (kNN) and support vector machine (SVM) based methods is also presented. Experiments have shown that (i) our proposed framework can identify multiple types of cells with over 99% accuracy based on label-free bright-field images efficiently; (ii) CNN-based models perform well and relatively stable against changes in data volume compared with kNN and SVM.
        </p>
      </abstract>
    </section>
    
    <section class="container">
      <h5 style="font-family: Markazi Text, serif; font-size: 30px"> <strong>Framework </strong> </h5>
      <figure class="text-center">
        <img src="materials/framework.svg" alt="framework" style="width: 90%">
        <figcaption style="font-family: Times New Roman; font-size: 20px; padding-top: 10px">Fig. 1: The framework of our deep CNN classification system for cell images</figcaption>
      </figure>
    </section>

    <section class="container">
      <h5 style="font-family: Markazi Text, serif; font-size: 30px"> 
        <strong> Data </strong>
      </h5>
      <figure id="barplot_cell_samples"></figure>
    </section>

		<section class="container">
      <h5 style="font-family: Markazi Text, serif; font-size: 30px"> 
        <strong> Downloads </strong>
      </h5>
      <div class="row" style="padding-left: 36px">
        <!-- The manuscript link -->
        <a href="materials/Largescale_Multiclass_Imagebased_Cell_Classification_with_Deep_Learning.pdf">
          <img src="icons/pdf_64x64.png" alt="pdf manuscript" style="width: 48px">
        </a>
        <p> 
          <a href="materials/Largescale_Multiclass_Imagebased_Cell_Classification_with_Deep_Learning.pdf">Paper</a> </br> 1.24 MB 
        </p>

        <!-- The small dataset link -->
        <a href="materials/Largescale_Multiclass_Imagebased_Cell_Classification_with_Deep_Learning.pdf">
          <img src="icons/zip_64x64.png" alt="dataset" style="width: 48px">
        </a>
        <p> 
          <a href="https://ieee-dataport.s3.amazonaws.com/data/2652/dataset1.zip?response-content-disposition=attachment%3B%20filename%3D%22dataset1.zip%22&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJOHYI4KJCE6Q7MIQ%2F20190310%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20190310T044411Z&X-Amz-SignedHeaders=Host&X-Amz-Expires=3600&X-Amz-Signature=e7eda6c56b9ae9525b5f1afdcb5c8761179650eb1000fa0348d8397431e44613">Dataset (small)</a> </br> 144 MB 
        </p>

        <!-- The large dataset link -->
        <a href="materials/Largescale_Multiclass_Imagebased_Cell_Classification_with_Deep_Learning.pdf">
          <img src="icons/zip_64x64.png" alt="dataset" style="width: 48px">
        </a>
        <p> 
          <a href="https://ieee-dataport.s3.amazonaws.com/data/2652/dataset2.zip?response-content-disposition=attachment%3B%20filename%3D%22dataset2.zip%22&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAJOHYI4KJCE6Q7MIQ%2F20190310%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20190310T044411Z&X-Amz-SignedHeaders=Host&X-Amz-Expires=3600&X-Amz-Signature=ee6fc41e8604bd6a381f24f389ef29acf02e8abf3f954a997e167dff8251e29a">Dataset (large)</a> </br> 1.4 GB 
        </p>
      </div>
    </section>

    




    <script>
      // set the margin of the SVG
      var margin = {top: 50, right: 50, bottom: 50, left: 100};

      // set the width and height using the current width and height of the div
      var width = 560 - margin.left - margin.right;
      var height = 360 - margin.top - margin.bottom;

      var figure = d3.select("#barplot_cell_samples").append("svg")
                     .attr("width", width + margin.left + margin.right)
                     .attr("height", height + margin.top + margin.bottom)
                     .append("g")
                     .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      // define the x and y axes
      var y = d3.scaleLinear()
                .range([height, 0])
                .domain([0,450000]);
      var x = d3.scaleBand()
                .range([0, width])
                .domain(["THP1", "MCF7", "MB231", "PBMC"])
                .padding(0.36);

      // plot the x and y coordinates
      figure.append("g").call(d3.axisLeft(y));
      figure.append("g").attr("transform", "translate(0," + height + ")").call(d3.axisBottom(x));


      var data = [
        {preaugment: 200951, afteraugment: 256000, type: "THP1"},
        {preaugment: 372000, afteraugment: 374427, type: "MCF7"},
        {preaugment: 350000, afteraugment: 353394, type: "MB231"},
        {preaugment: 21000,  afteraugment: 327198, type: "PBMC"}
      ];

      var colors = ["#ff9999", "#9999ff"];


      // add dash line grid
      figure.append("g")
            .attr("class", "grid")
            .style("stroke-dasharray", "3 3")
            .style("opacity", "0.36")
            // .attr("transform", "translate(0, ${height})")
            .call(d3.axisLeft()
                    .scale(y)
                    .tickSize(-width, 0, 0)
                    .tickFormat("")
                 )

      // define the bar group
      // const bargroup = figure.selectAll()
      //                        .

      // add preaugment bars
      figure.selectAll()
            .data(data)      
            .enter()
            .append("rect")
            .attr("class", "bar")
            .style("fill", colors[0])
            .style("stroke", colors[0])
            .attr("x", function(d) { return x(d.type); })
            .attr("width", x.bandwidth() / 2.03)
            .attr("y", function(d) { return y(d.preaugment); })
            .attr("height", function(d) {return height - y(d.preaugment)})
            .on('mouseenter', function (s, i) {
              d3.select(this)
                .attr("opacity", 1)
                .transition()
                .duration(300)
                .attr("opacity", 0.6)
                .style("stroke", "red")

              const yvalue = y(s.preaugment)
              const xvalue = x(s.type)

              figure.append("line")
                    // .transition()
                    // .duration(300)
                    .attr("id", "limit")
                    .attr("x1", 0)
                    .attr("y1", yvalue)
                    .attr("x2", width)
                    .attr("y2", yvalue)
                    .attr("stroke", "red")
                    .attr("stroke-dasharray", "5 5")

              figure.append("text")
                    .attr("class", "labeltip")
                    .attr("x", 0)
                    .attr("y", yvalue - 5)
                    .text(s.preaugment)
                    .style("font-family", "Times")
                    .style("font-weight", "bold")
                    .style("font-style", "italic")
                    .style("fill", "#ff7777")
            })
            .on('mouseleave', function (s, i) {
              d3.select(this)
                .attr("opacity", 0.6)
                .transition()
                .duration(300)
                .attr("opacity", 1)
                .style("stroke", colors[0])

              d3.selectAll("#limit").remove()
              d3.selectAll(".labeltip").remove()
            });


      // add afteraugment bars
      figure.selectAll()
            .data(data)      
            .enter()
            .append("rect")
            .style("fill", colors[1])
            .attr("x", function(d) { return x(d.type); })
            .attr("width", x.bandwidth() / 2)
            .attr("transform", "translate("+x.bandwidth() / 2+",0)")
            .attr("y", function(d) { return y(d.afteraugment); })
            .attr("height", function(d) {return height - y(d.afteraugment)})
            .on('mouseenter', function (s, i) {
              d3.select(this)
                .attr('opacity', 1)
                .transition()
                .duration(300)
                .attr('opacity', 0.6)
                .style("stroke", "blue")

              const yvalue = y(s.afteraugment)

              figure.append("line")
                    .attr("id", "limit")
                    .attr("x1", 0)
                    .attr("y1", yvalue)
                    .attr("x2", width)
                    .attr("y2", yvalue)
                    .attr("stroke", "blue")
                    .attr("stroke-dasharray", "5 5")


              figure.append("text")
                    .attr("class", "labeltip")
                    .attr("x", 0)
                    .attr("y", yvalue - 5)
                    .text(s.afteraugment)
                    .style("font-family", "Times")
                    .style("font-weight", "bold")
                    .style("font-style", "italic")
                    .style("fill", "#7777ff")
            })
            .on('mouseleave', function (s, i) {
              d3.select(this)
                .attr('opacity', 0.6)
                .transition()
                .duration(300)
                .attr('opacity', 1)
                .style("stroke", colors[1])


              d3.selectAll("#limit").remove()
              d3.selectAll(".labeltip").remove()
            });


      // add text label to y coordinates
      figure.append("text")
            .attr("x", -(height / 2) - margin.top)
            .attr("y", -margin.left / 1.6)
            .attr("transform", "rotate(-90)")
            .text("Number of cells")
            .style("font-family", "Times")
            .style("font-weight", "bold")
            .style("font-size", "12pt");

      // add text label to x coordinates
      figure.append("text")
            .attr("x", (width - margin.left) / 2)
            .attr("y", height + margin.top / 1.2)
            .text("Cell types")
            .style("font-family", "Times")
            .style("font-weight", "bold")
            .style("font-size", "12pt");

      // draw legend
      var legend = figure.selectAll(".legend")
                         .data(colors)


      //  ====================================== visualization of cells ====================================== //


    </script>

    <section class="container">
      <h5 style="font-family: Markazi Text, serif; font-size: 30px">
        <strong>Bibtex </strong>
      </h5>
      <pre>
        @article{Meng2018Largescale,
          title={Large-scale Multi-class Image-based Cell Classification with Deep Learning},
          author={Meng, Nan and Lam, Edmund and Tsia, Kevin Kin Man and So, Hayden Kwok-Hay},
          journal={IEEE journal of biomedical and health informatics},
          year={2018},
          publisher={IEEE}
        }
      </pre>
    </section>
	</body>
</html>